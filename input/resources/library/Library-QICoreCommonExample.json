{
  "resourceType": "Library",
  "id": "QICoreCommonExample",
  "extension": [ {
    "url": "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  } ],
  "url": "http://somewhere.org/fhir/uv/mycontentig/Library/QICoreCommonExample",
  "version": "0.4.9-cibuild",
  "name": "QICoreCommonExample",
  "type": {
    "coding": [ {
      "system": "http://terminology.hl7.org/CodeSystem/library-type",
      "code": "logic-library"
    } ]
  },
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBRSUNvcmVDb21tb25FeGFtcGxlIHZlcnNpb24gJzAuNC45LWNpYnVpbGQnDQoNCnVzaW5nIFFJQ29yZSB2ZXJzaW9uICc0LjEuMScNCg0KaW5jbHVkZSBGSElSSGVscGVycyB2ZXJzaW9uICc0LjAuMScNCg0KY29kZXN5c3RlbSAiTE9JTkMiOiAnaHR0cDovL2xvaW5jLm9yZycNCmNvZGVzeXN0ZW0gIlNOT01FRENUIjogJ2h0dHA6Ly9zbm9tZWQuaW5mby9zY3QnDQpjb2Rlc3lzdGVtICJBY3RDb2RlIjogJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vdjMtQWN0Q29kZScNCmNvZGVzeXN0ZW0gIlJvbGVDb2RlIjogJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vdjMtUm9sZUNvZGUnDQpjb2Rlc3lzdGVtICJEaWFnbm9zaXMgUm9sZSI6ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2RpYWdub3Npcy1yb2xlJw0KY29kZXN5c3RlbSAiUmVxdWVzdEludGVudCI6ICdodHRwOi8vaGw3Lm9yZy9maGlyL3JlcXVlc3QtaW50ZW50Jw0KY29kZXN5c3RlbSAiTWVkaWNhdGlvblJlcXVlc3RDYXRlZ29yeSI6ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL21lZGljYXRpb25yZXF1ZXN0LWNhdGVnb3J5Jw0KY29kZXN5c3RlbSAiQ29uZGl0aW9uQ2xpbmljYWxTdGF0dXNDb2RlcyI6ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2NvbmRpdGlvbi1jbGluaWNhbCcNCmNvZGVzeXN0ZW0gIkNvbmRpdGlvblZlcmlmaWNhdGlvblN0YXR1c0NvZGVzIjogJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vY29uZGl0aW9uLXZlci1zdGF0dXMnDQpjb2Rlc3lzdGVtICJBbGxlcmd5SW50b2xlcmFuY2VDbGluaWNhbFN0YXR1c0NvZGVzIjogJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vYWxsZXJneWludG9sZXJhbmNlLWNsaW5pY2FsJw0KY29kZXN5c3RlbSAiQWxsZXJneUludG9sZXJhbmNlVmVyaWZpY2F0aW9uU3RhdHVzQ29kZXMiOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9hbGxlcmd5aW50b2xlcmFuY2UtdmVyaWZpY2F0aW9uJw0KY29kZXN5c3RlbSAiT2JzZXJ2YXRpb25DYXRlZ29yeUNvZGVzIjogJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vb2JzZXJ2YXRpb24tY2F0ZWdvcnknDQpjb2Rlc3lzdGVtICJVU0NvcmVPYnNlcnZhdGlvbkNhdGVnb3J5RXh0ZW5zaW9uQ29kZXMiOiAnaHR0cDovL2hsNy5vcmcvZmhpci91cy9jb3JlL0NvZGVTeXN0ZW0vdXMtY29yZS1vYnNlcnZhdGlvbi1jYXRlZ29yeScgIA0KY29kZXN5c3RlbSAiQ29uZGl0aW9uQ2F0ZWdvcnkiOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9jb25kaXRpb24tY2F0ZWdvcnknDQpjb2Rlc3lzdGVtICJVU0NvcmVDb25kaXRpb25DYXRlZ29yeUV4dGVuc2lvbkNvZGVzIjogJ2h0dHA6Ly9obDcub3JnL2ZoaXIvdXMvY29yZS9Db2RlU3lzdGVtL2NvbmRpdGlvbi1jYXRlZ29yeScNCg0KY29kZSAiQmlydGhkYXRlIjogJzIxMTEyLTgnIGZyb20gIkxPSU5DIiBkaXNwbGF5ICdCaXJ0aCBkYXRlJw0KY29kZSAiRGVhZCI6ICc0MTkwOTkwMDknIGZyb20gIlNOT01FRENUIiBkaXNwbGF5ICdEZWFkJw0KY29kZSAiRVIiOiAnRVInIGZyb20gIlJvbGVDb2RlIiBkaXNwbGF5ICdFbWVyZ2VuY3kgcm9vbScNCmNvZGUgIklDVSI6ICdJQ1UnIGZyb20gIlJvbGVDb2RlIiBkaXNwbGF5ICdJbnRlbnNpdmUgY2FyZSB1bml0Jw0KY29kZSAiQmlsbGluZyI6ICdiaWxsaW5nJyBmcm9tICJEaWFnbm9zaXMgUm9sZSIgZGlzcGxheSAnQmlsbGluZycNCg0KLy8gRW5jb3VudGVyIENsYXNzIENvZGVzDQpjb2RlICJhbWJ1bGF0b3J5IjogJ0FNQicgZnJvbSBBY3RDb2RlIGRpc3BsYXkgJ2FtYnVsYXRvcnknDQpjb2RlICJlbWVyZ2VuY3kiOiAnRU1FUicgZnJvbSBBY3RDb2RlIGRpc3BsYXkgJ2VtZXJnZW5jeScNCmNvZGUgImZpZWxkIjogJ0ZMRCcgZnJvbSBBY3RDb2RlIGRpc3BsYXkgJ2ZpZWxkJw0KY29kZSAiaG9tZSBoZWFsdGgiOiAnSEgnIGZyb20gQWN0Q29kZSBkaXNwbGF5ICdob21lIGhlYWx0aCcNCmNvZGUgImlucGF0aWVudCBlbmNvdW50ZXIiOiAnSU1QJyBmcm9tIEFjdENvZGUgZGlzcGxheSAnaW5wYXRpZW50IGVuY291bnRlcicNCmNvZGUgImlucGF0aWVudCBhY3V0ZSI6ICdBQ1VURScgZnJvbSBBY3RDb2RlIGRpc3BsYXkgJ2lucGF0aWVudCBhY3V0ZScNCmNvZGUgImlucGF0aWVudCBub24tYWN1dGUiOiAnTk9OQUMnIGZyb20gQWN0Q29kZSBkaXNwbGF5ICdpbnBhdGllbnQgbm9uLWFjdXRlJw0KY29kZSAib2JzZXJ2YXRpb24gZW5jb3VudGVyIjogJ09CU0VOQycgZnJvbSBBY3RDb2RlIGRpc3BsYXkgJ29ic2VydmF0aW9uIGVuY291bnRlcicNCmNvZGUgInByZS1hZG1pc3Npb24iOiAnUFJFTkMnIGZyb20gQWN0Q29kZSBkaXNwbGF5ICdwcmUtYWRtaXNzaW9uJw0KY29kZSAic2hvcnQgc3RheSI6ICdTUycgZnJvbSBBY3RDb2RlIGRpc3BsYXkgJ3Nob3J0IHN0YXknDQpjb2RlICJ2aXJ0dWFsIjogJ1ZSJyBmcm9tIEFjdENvZGUgZGlzcGxheSAnVlInDQoNCi8vIENvbmRpdGlvbiBDYXRlZ29yeSBDb2Rlcw0KY29kZSAicHJvYmxlbS1saXN0LWl0ZW0iOiAncHJvYmxlbS1saXN0LWl0ZW0nIGZyb20gIkNvbmRpdGlvbkNhdGVnb3J5IiBkaXNwbGF5ICdQcm9ibGVtIExpc3QgSXRlbScNCmNvZGUgImVuY291bnRlci1kaWFnbm9zaXMiOiAnZW5jb3VudGVyLWRpYWdub3NpcycgZnJvbSAiQ29uZGl0aW9uQ2F0ZWdvcnkiIGRpc3BsYXkgJ0VuY291bnRlciBEaWFnbm9zaXMnDQpjb2RlICJoZWFsdGgtY29uY2VybiI6ICdoZWFsdGgtY29uY2VybicgZnJvbSAiVVNDb3JlQ29uZGl0aW9uQ2F0ZWdvcnlFeHRlbnNpb25Db2RlcyIgZGlzcGxheSAnSGVhbHRoIENvbmNlcm4nDQoNCi8vIENvbmRpdGlvbiBDbGluaWNhbCBTdGF0dXMgQ29kZXMgLSBDb25zaWRlciB2YWx1ZSBzZXRzIGZvciB0aGVzZQ0KY29kZSAiYWN0aXZlIjogJ2FjdGl2ZScgZnJvbSAiQ29uZGl0aW9uQ2xpbmljYWxTdGF0dXNDb2RlcyINCmNvZGUgInJlY3VycmVuY2UiOiAncmVjdXJyZW5jZScgZnJvbSAiQ29uZGl0aW9uQ2xpbmljYWxTdGF0dXNDb2RlcyINCmNvZGUgInJlbGFwc2UiOiAncmVsYXBzZScgZnJvbSAiQ29uZGl0aW9uQ2xpbmljYWxTdGF0dXNDb2RlcyINCmNvZGUgImluYWN0aXZlIjogJ2luYWN0aXZlJyBmcm9tICJDb25kaXRpb25DbGluaWNhbFN0YXR1c0NvZGVzIg0KY29kZSAicmVtaXNzaW9uIjogJ3JlbWlzc2lvbicgZnJvbSAiQ29uZGl0aW9uQ2xpbmljYWxTdGF0dXNDb2RlcyINCmNvZGUgInJlc29sdmVkIjogJ3Jlc29sdmVkJyBmcm9tICJDb25kaXRpb25DbGluaWNhbFN0YXR1c0NvZGVzIg0KDQovLyBDb25kaXRpb24gVmVyaWZpY2F0aW9uIFN0YXR1cyBDb2RlcyAtIENvbnNpZGVyIHZhbHVlIHNldHMgZm9yIHRoZXNlDQpjb2RlICJ1bmNvbmZpcm1lZCI6ICd1bmNvbmZpcm1lZCcgZnJvbSBDb25kaXRpb25WZXJpZmljYXRpb25TdGF0dXNDb2Rlcw0KY29kZSAicHJvdmlzaW9uYWwiOiAncHJvdmlzaW9uYWwnIGZyb20gQ29uZGl0aW9uVmVyaWZpY2F0aW9uU3RhdHVzQ29kZXMNCmNvZGUgImRpZmZlcmVudGlhbCI6ICdkaWZmZXJlbnRpYWwnIGZyb20gQ29uZGl0aW9uVmVyaWZpY2F0aW9uU3RhdHVzQ29kZXMNCmNvZGUgImNvbmZpcm1lZCI6ICdjb25maXJtZWQnIGZyb20gQ29uZGl0aW9uVmVyaWZpY2F0aW9uU3RhdHVzQ29kZXMNCmNvZGUgInJlZnV0ZWQiOiAncmVmdXRlZCcgZnJvbSBDb25kaXRpb25WZXJpZmljYXRpb25TdGF0dXNDb2Rlcw0KY29kZSAiZW50ZXJlZC1pbi1lcnJvciI6ICdlbnRlcmVkLWluLWVycm9yJyBmcm9tIENvbmRpdGlvblZlcmlmaWNhdGlvblN0YXR1c0NvZGVzDQoNCmNvZGUgImFsbGVyZ3ktYWN0aXZlIjogJ2FjdGl2ZScgZnJvbSAiQWxsZXJneUludG9sZXJhbmNlQ2xpbmljYWxTdGF0dXNDb2RlcyINCmNvZGUgImFsbGVyZ3ktaW5hY3RpdmUiOiAnaW5hY3RpdmUnIGZyb20gIkFsbGVyZ3lJbnRvbGVyYW5jZUNsaW5pY2FsU3RhdHVzQ29kZXMiDQpjb2RlICJhbGxlcmd5LXJlc29sdmVkIjogJ3Jlc29sdmVkJyBmcm9tICJBbGxlcmd5SW50b2xlcmFuY2VDbGluaWNhbFN0YXR1c0NvZGVzIg0KDQovLyBBbGxlcmd5L0ludG9sZXJhbmNlIFZlcmlmaWNhdGlvbiBTdGF0dXMgQ29kZXMgLSBDb25zaWRlciB2YWx1ZSBzZXRzIGZvciB0aGVzZQ0KY29kZSAiYWxsZXJneS11bmNvbmZpcm1lZCI6ICd1bmNvbmZpcm1lZCcgZnJvbSBBbGxlcmd5SW50b2xlcmFuY2VWZXJpZmljYXRpb25TdGF0dXNDb2Rlcw0KY29kZSAiYWxsZXJneS1jb25maXJtZWQiOiAnY29uZmlybWVkJyBmcm9tIEFsbGVyZ3lJbnRvbGVyYW5jZVZlcmlmaWNhdGlvblN0YXR1c0NvZGVzDQpjb2RlICJhbGxlcmd5LXJlZnV0ZWQiOiAncmVmdXRlZCcgZnJvbSBBbGxlcmd5SW50b2xlcmFuY2VWZXJpZmljYXRpb25TdGF0dXNDb2Rlcw0KDQovLyBNZWRpY2F0aW9uUmVxdWVzdCBDYXRlZ29yeSBDb2Rlcw0KY29kZSAiSW5wYXRpZW50IjogJ2lucGF0aWVudCcgZnJvbSAiTWVkaWNhdGlvblJlcXVlc3RDYXRlZ29yeSIgZGlzcGxheSAnSW5wYXRpZW50Jw0KY29kZSAiT3V0cGF0aWVudCI6ICdvdXRwYXRpZW50JyBmcm9tICJNZWRpY2F0aW9uUmVxdWVzdENhdGVnb3J5IiBkaXNwbGF5ICdPdXRwYXRpZW50Jw0KY29kZSAiQ29tbXVuaXR5IjogJ2NvbW11bml0eScgZnJvbSAiTWVkaWNhdGlvblJlcXVlc3RDYXRlZ29yeSIgZGlzcGxheSAnQ29tbXVuaXR5Jw0KY29kZSAiRGlzY2hhcmdlIjogJ2Rpc2NoYXJnZScgZnJvbSAiTWVkaWNhdGlvblJlcXVlc3RDYXRlZ29yeSIgZGlzcGxheSAnRGlzY2hhcmdlJw0KDQovLyBEaWFnbm9zaXMgUm9sZSBDb2Rlcw0KY29kZSAiQUQiOiAnQUQnIGZyb20gIkRpYWdub3NpcyBSb2xlIiBkaXNwbGF5ICdBZG1pc3Npb24gZGlhZ25vc2lzJw0KY29kZSAiREQiOiAnREQnIGZyb20gIkRpYWdub3NpcyBSb2xlIiBkaXNwbGF5ICdEaXNjaGFyZ2UgZGlhZ25vc2lzJw0KY29kZSAiQ0MiOiAnQ0MnIGZyb20gIkRpYWdub3NpcyBSb2xlIiBkaXNwbGF5ICdDaGllZiBjb21wbGFpbnQnDQpjb2RlICJDTSI6ICdDTScgZnJvbSAiRGlhZ25vc2lzIFJvbGUiIGRpc3BsYXkgJ0NvbW9yYmlkaXR5IGRpYWdub3NpcycNCmNvZGUgInByZS1vcCI6ICdwcmUtb3AnIGZyb20gIkRpYWdub3NpcyBSb2xlIiBkaXNwbGF5ICdwcmUtb3AgZGlhZ25vc2lzJw0KY29kZSAicG9zdC1vcCI6ICdwb3N0LW9wJyBmcm9tICJEaWFnbm9zaXMgUm9sZSIgZGlzcGxheSAncG9zdC1vcCBkaWFnbm9zaXMnDQpjb2RlICJiaWxsaW5nIjogJ2JpbGxpbmcnIGZyb20gIkRpYWdub3NpcyBSb2xlIiBkaXNwbGF5ICdiaWxsaW5nIGRpYWdub3NpcycNCg0KLy8gT2JzZXJ2YXRpb24gQ2F0ZWdvcnkgQ29kZXMNCmNvZGUgInNvY2lhbC1oaXN0b3J5IjogJ3NvY2lhbC1oaXN0b3J5JyBmcm9tICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ1NvY2lhbCBIaXN0b3J5Jw0KY29kZSAidml0YWwtc2lnbnMiOiAndml0YWwtc2lnbnMnIGZyb20gIk9ic2VydmF0aW9uQ2F0ZWdvcnlDb2RlcyIgZGlzcGxheSAnVml0YWwgU2lnbnMnDQpjb2RlICJpbWFnaW5nIjogJ2ltYWdpbmcnIGZyb20gIk9ic2VydmF0aW9uQ2F0ZWdvcnlDb2RlcyIgZGlzcGxheSAnSW1hZ2luZycNCmNvZGUgImxhYm9yYXRvcnkiOiAnbGFib3JhdG9yeScgZnJvbSAiT2JzZXJ2YXRpb25DYXRlZ29yeUNvZGVzIiBkaXNwbGF5ICdMYWJvcmF0b3J5Jw0KY29kZSAicHJvY2VkdXJlIjogJ3Byb2NlZHVyZScgZnJvbSAiT2JzZXJ2YXRpb25DYXRlZ29yeUNvZGVzIiBkaXNwbGF5ICdQcm9jZWR1cmUnDQpjb2RlICJzdXJ2ZXkiOiAnc3VydmV5JyBmcm9tICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ1N1cnZleScNCmNvZGUgImV4YW0iOiAnZXhhbScgZnJvbSAiT2JzZXJ2YXRpb25DYXRlZ29yeUNvZGVzIiBkaXNwbGF5ICdFeGFtJw0KY29kZSAidGhlcmFweSI6ICd0aGVyYXB5JyBmcm9tICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ1RoZXJhcHknDQpjb2RlICJhY3Rpdml0eSI6ICdhY3Rpdml0eScgZnJvbSAiT2JzZXJ2YXRpb25DYXRlZ29yeUNvZGVzIiBkaXNwbGF5ICdBY3Rpdml0eScNCmNvZGUgImNsaW5pY2FsLXRlc3QiOiAnY2xpbmljYWwtdGVzdCcgZnJvbSAiVVNDb3JlT2JzZXJ2YXRpb25DYXRlZ29yeUV4dGVuc2lvbkNvZGVzIiBkaXNwbGF5ICdDbGluaWNhbCBUZXN0Jw0KDQpjb250ZXh0IFBhdGllbnQNCg0KLyogQ2FuZGlkYXRlcyBmb3IgRkhJUkNvbW1vbiAqLw0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIGNvbmRpdGlvbiBoYXMgYSBjbGluaWNhbCBzdGF0dXMgb2YgYWN0aXZlLCByZWN1cnJlbmNlLCBvciByZWxhcHNlDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBpc0FjdGl2ZShjb25kaXRpb24gQ29uZGl0aW9uKToNCiAgY29uZGl0aW9uLmNsaW5pY2FsU3RhdHVzIH4gImFjdGl2ZSINCiAgICBvciBjb25kaXRpb24uY2xpbmljYWxTdGF0dXMgfiAicmVjdXJyZW5jZSINCiAgICBvciBjb25kaXRpb24uY2xpbmljYWxTdGF0dXMgfiAicmVsYXBzZSINCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBjb25kaXRpb24gaGFzIHRoZSBnaXZlbiBjYXRlZ29yeQ0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaGFzQ2F0ZWdvcnkoY29uZGl0aW9uIENvbmRpdGlvbiwgY2F0ZWdvcnkgQ29kZSk6DQogIGV4aXN0cyAoY29uZGl0aW9uLmNhdGVnb3J5IEMNCiAgICB3aGVyZSBDIH4gY2F0ZWdvcnkNCiAgKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIGNvbmRpdGlvbiBpcyBhIHByb2JsZW0gbGlzdCBpdGVtLg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaXNQcm9ibGVtTGlzdEl0ZW0oY29uZGl0aW9uIENvbmRpdGlvbik6DQogIGV4aXN0cyAoY29uZGl0aW9uLmNhdGVnb3J5IEMNCiAgICB3aGVyZSBDIH4gInByb2JsZW0tbGlzdC1pdGVtIg0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gY29uZGl0aW9uIGlzIGFuIGVuY291bnRlciBkaWFnbm9zaXMNCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGlzRW5jb3VudGVyRGlhZ25vc2lzKGNvbmRpdGlvbiBDb25kaXRpb24pOg0KICBleGlzdHMgKGNvbmRpdGlvbi5jYXRlZ29yeSBDDQogICAgd2hlcmUgQyB+ICJlbmNvdW50ZXItZGlhZ25vc2lzIg0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gY29uZGl0aW9uIGlzIGEgaGVhbHRoIGNvbmNlcm4NCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGlzSGVhbHRoQ29uY2Vybihjb25kaXRpb24gQ29uZGl0aW9uKToNCiAgZXhpc3RzIChjb25kaXRpb24uY2F0ZWdvcnkgQw0KICAgIHdoZXJlIEMgfiAiaGVhbHRoLWNvbmNlcm4iDQogICkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBvYnNlcnZhdGlvbiBoYXMgdGhlIGdpdmVuIGNhdGVnb3J5DQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBoYXNDYXRlZ29yeShvYnNlcnZhdGlvbiBPYnNlcnZhdGlvbiwgY2F0ZWdvcnkgQ29kZSk6DQogIGV4aXN0cyAob2JzZXJ2YXRpb24uY2F0ZWdvcnkgQw0KICAgIHdoZXJlIEMgfiBjYXRlZ29yeQ0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gb2JzZXJ2YXRpb24gaXMgYSBzb2NpYWwgaGlzdG9yeSBvYnNlcnZhdGlvbg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaXNTb2NpYWxIaXN0b3J5KG9ic2VydmF0aW9uIE9ic2VydmF0aW9uKToNCiAgZXhpc3RzIChvYnNlcnZhdGlvbi5jYXRlZ29yeSBDDQogICAgd2hlcmUgQyB+ICJzb2NpYWwtaGlzdG9yeSINCiAgKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIG9ic2VydmF0aW9uIGlzIGEgdml0YWwgc2lnbg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaXNWaXRhbFNpZ24ob2JzZXJ2YXRpb24gT2JzZXJ2YXRpb24pOg0KICBleGlzdHMgKG9ic2VydmF0aW9uLmNhdGVnb3J5IEMNCiAgICB3aGVyZSBDIH4gInZpdGFsLXNpZ25zIg0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gb2JzZXJ2YXRpb24gaXMgYW4gaW1hZ2luZyBvYnNlcnZhdGlvbg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaXNJbWFnaW5nKG9ic2VydmF0aW9uIE9ic2VydmF0aW9uKToNCiAgZXhpc3RzIChvYnNlcnZhdGlvbi5jYXRlZ29yeSBDDQogICAgd2hlcmUgQyB+ICJpbWFnaW5nIg0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gb2JzZXJ2YXRpb24gaXMgYSBsYWJvcmF0b3J5IG9ic2VydmF0aW9uDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBpc0xhYm9yYXRvcnkob2JzZXJ2YXRpb24gT2JzZXJ2YXRpb24pOg0KICBleGlzdHMgKG9ic2VydmF0aW9uLmNhdGVnb3J5IEMNCiAgICB3aGVyZSBDIH4gImxhYm9yYXRvcnkiDQogICkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUkV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBvYnNlcnZhdGlvbiBpcyBhIHByb2NlZHVyZSBvYnNlcnZhdGlvbg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaXNQcm9jZWR1cmUob2JzZXJ2YXRpb24gT2JzZXJ2YXRpb24pOg0KICBleGlzdHMgKG9ic2VydmF0aW9uLmNhdGVnb3J5IEMNCiAgICB3aGVyZSBDIH4gInByb2NlZHVyZSINCiAgKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIG9ic2VydmF0aW9uIGlzIGEgc3VydmV5IG9ic2VydmF0aW9uDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBpc1N1cnZleShvYnNlcnZhdGlvbiBPYnNlcnZhdGlvbik6DQogIGV4aXN0cyAob2JzZXJ2YXRpb24uY2F0ZWdvcnkgQw0KICAgIHdoZXJlIEMgfiAic3VydmV5Ig0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gb2JzZXJ2YXRpb24gaXMgYW4gZXhhbSBvYnNlcnZhdGlvbg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaXNFeGFtKG9ic2VydmF0aW9uIE9ic2VydmF0aW9uKToNCiAgZXhpc3RzIChvYnNlcnZhdGlvbi5jYXRlZ29yeSBDDQogICAgd2hlcmUgQyB+ICJleGFtIg0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gb2JzZXJ2YXRpb24gaXMgYSB0aGVyYXB5IG9ic2VydmF0aW9uDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBpc1RoZXJhcHkob2JzZXJ2YXRpb24gT2JzZXJ2YXRpb24pOg0KICBleGlzdHMgKG9ic2VydmF0aW9uLmNhdGVnb3J5IEMNCiAgICB3aGVyZSBDIH4gInRoZXJhcHkiDQogICkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBvYnNlcnZhdGlvbiBpcyBhbiBhY3Rpdml0eSBvYnNlcnZhdGlvbg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaXNBY3Rpdml0eShvYnNlcnZhdGlvbiBPYnNlcnZhdGlvbik6DQogIGV4aXN0cyAob2JzZXJ2YXRpb24uY2F0ZWdvcnkgQw0KICAgIHdoZXJlIEMgfiAiYWN0aXZpdHkiDQogICkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBvYnNlcnZhdGlvbiBpcyBhIGNsaW5pY2FsIHRlc3QgcmVzdWx0DQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBpc0NsaW5pY2FsVGVzdChvYnNlcnZhdGlvbiBPYnNlcnZhdGlvbik6DQogIGV4aXN0cyAob2JzZXJ2YXRpb24uY2F0ZWdvcnkgQw0KICAgIHdoZXJlIEMgfiAiY2xpbmljYWwtdGVzdCINCiAgKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIE1lZGljYXRpb25SZXF1ZXN0IGhhcyBhIGNhdGVnb3J5IG9mIENvbW11bml0eQ0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaXNDb21tdW5pdHkobWVkaWNhdGlvblJlcXVlc3QgTWVkaWNhdGlvblJlcXVlc3QpOg0KICBleGlzdHMgKG1lZGljYXRpb25SZXF1ZXN0LmNhdGVnb3J5IEMNCiAgICB3aGVyZSBDIH4gQ29tbXVuaXR5DQogICkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBNZWRpY2F0aW9uUmVxdWVzdCBoYXMgYSBjYXRlZ29yeSBvZiBDb21tdW5pdHkNCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGlzQ29tbXVuaXR5KG1lZGljYXRpb25SZXF1ZXN0IE1lZGljYXRpb25Ob3RSZXF1ZXN0ZWQpOg0KICBleGlzdHMgKG1lZGljYXRpb25SZXF1ZXN0LmNhdGVnb3J5IEMNCiAgICB3aGVyZSBDIH4gQ29tbXVuaXR5DQogICkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBNZWRpY2F0aW9uUmVxdWVzdCBoYXMgYSBjYXRlZ29yeSBvZiBEaXNjaGFyZ2UNCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGlzRGlzY2hhcmdlKG1lZGljYXRpb25SZXF1ZXN0IE1lZGljYXRpb25SZXF1ZXN0KToNCiAgZXhpc3RzIChtZWRpY2F0aW9uUmVxdWVzdC5jYXRlZ29yeSBDDQogICAgd2hlcmUgQyB+IERpc2NoYXJnZQ0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gTWVkaWNhdGlvblJlcXVlc3QgaGFzIGEgY2F0ZWdvcnkgb2YgRGlzY2hhcmdlDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBpc0Rpc2NoYXJnZShtZWRpY2F0aW9uUmVxdWVzdCBNZWRpY2F0aW9uTm90UmVxdWVzdGVkKToNCiAgZXhpc3RzIChtZWRpY2F0aW9uUmVxdWVzdC5jYXRlZ29yeSBDDQogICAgd2hlcmUgQyB+IERpc2NoYXJnZQ0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gRGV2aWNlUmVxdWVzdCBpcyBhIG5lZ2F0aW9uIChpLmUuIGRvIG5vdCBwZXJmb3JtIHRoaXMgb3JkZXIpDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBkb05vdFBlcmZvcm0oZGV2aWNlUmVxdWVzdCBEZXZpY2VSZXF1ZXN0KToNCiAgc2luZ2xldG9uIGZyb20gKA0KICAgIGRldmljZVJlcXVlc3QubW9kaWZpZXJFeHRlbnNpb24gRQ0KICAgICAgd2hlcmUgRS51cmwgPSAnaHR0cDovL2hsNy5vcmcvZmhpci91cy9xaWNvcmUvU3RydWN0dXJlRGVmaW5pdGlvbi9xaWNvcmUtZG9Ob3RQZXJmb3JtJw0KICAgICAgcmV0dXJuIEUudmFsdWUgYXMgQm9vbGVhbg0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IE5vcm1hbGl6ZXMgYSB2YWx1ZSB0aGF0IGlzIGEgY2hvaWNlIG9mIHRpbWluZy12YWx1ZWQgdHlwZXMgdG8gYW4gZXF1aXZhbGVudCBpbnRlcnZhbA0KQGNvbW1lbnQ6IE5vcm1hbGl6ZXMgYSBjaG9pY2UgdHlwZSBvZiBEYXRlVGltZSwgUXVhbml0dHksIEludGVydmFsPERhdGVUaW1lPiwgb3IgSW50ZXJ2YWw8UXVhbnRpdHk+IHR5cGVzDQp0byBhbiBlcXVpdmFsZW50IGludGVydmFsLiBUaGlzIHNlbGVjdGlvbiBvZiBjaG9pY2UgdHlwZXMgaXMgYSBzdXBlcnNldCBvZiB0aGUgbWFqb3JpdHkgb2YgY2hvaWNlIHR5cGVzIHRoYXQgYXJlIHVzZWQgYXMgcG9zc2libGUNCnJlcHJlc2VudGF0aW9ucyBmb3IgdGltaW5nLXZhbHVlZCBlbGVtZW50cyBpbiBRSUNvcmUsIGFsbG93aW5nIHRoaXMgZnVuY3Rpb24gdG8gYmUgdXNlZCBhY3Jvc3MgYW55IHJlc291cmNlLg0KVGhlIGlucHV0IGNhbiBiZSBwcm92aWRlZCBhcyBhIERhdGVUaW1lLCBRdWFudGl0eSwgSW50ZXJ2YWw8RGF0ZVRpbWU+IG9yIEludGVydmFsPFF1YW50aXR5Pi4NClRoZSBpbnRlbnQgb2YgdGhpcyBmdW5jdGlvbiBpcyB0byBwcm92aWRlIGEgY2xlYXIgYW5kIGNvbmNpc2UgbWVjaGFuaXNtIHRvIHRyZWF0IHNpbmdsZQ0KZWxlbWVudHMgdGhhdCBoYXZlIG11bHRpcGxlIHBvc3NpYmxlIHJlcHJlc2VudGF0aW9ucyBhcyBpbnRlcnZhbHMgc28gdGhhdCBsb2dpYyBkb2Vzbid0IGhhdmUgdG8gYWNjb3VudA0KZm9yIHRoZSB2YXJpYWJpbGl0eS4gTW9yZSBjb21wbGV4IGNhbGN1bGF0aW9ucyAoc3VjaCBhcyBtZWRpY2F0aW9uIHJlcXVlc3QgcGVyaW9kIG9yIGRpc3BlbnNlIHBlcmlvZA0KY2FsY3VsYXRpb24pIG5lZWQgc3BlY2lmaWMgZ3VpZGFuY2UgYW5kIGNvbnNpZGVyYXRpb24uIFRoYXQgZ3VpZGFuY2UgbWF5IG1ha2UgdXNlIG9mIHRoaXMgZnVuY3Rpb24sIGJ1dA0KdGhlIGZvY3VzIG9mIHRoaXMgZnVuY3Rpb24gaXMgb24gc2luZ2xlIGVsZW1lbnQgY2FsY3VsYXRpb25zIHdoZXJlIHRoZSBzZW1hbnRpY3MgYXJlIHVuYW1iaWd1b3VzLg0KSWYgdGhlIGlucHV0IGlzIGEgRGF0ZVRpbWUsIHRoZSByZXN1bHQgYSBEYXRlVGltZSBJbnRlcnZhbCBiZWdpbm5pbmcgYW5kIGVuZGluZyBvbiB0aGF0IERhdGVUaW1lLg0KSWYgdGhlIGlucHV0IGlzIGEgUXVhbnRpdHksIHRoZSBxdWFudGl0eSBpcyBleHBlY3RlZCB0byBiZSBhIGNhbGVuZGFyLWR1cmF0aW9uIGludGVycHJldGVkIGFzIGFuIEFnZSwNCmFuZCB0aGUgcmVzdWx0IGlzIGEgRGF0ZVRpbWUgSW50ZXJ2YWwgYmVnaW5uaW5nIG9uIHRoZSBEYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGF0IGFnZSBhbmQgZW5kaW5nIGltbWVkaWF0ZWx5IGJlZm9yZSBvbmUgeWVhciBsYXRlci4NCklmIHRoZSBpbnB1dCBpcyBhIERhdGVUaW1lIEludGVydmFsLCB0aGUgcmVzdWx0IGlzIHRoZSBpbnB1dC4NCklmIHRoZSBpbnB1dCBpcyBhIFF1YW50aXR5IEludGVydmFsLCB0aGUgcXVhbnRpdGllcyBhcmUgZXhwZWN0ZWQgdG8gYmUgY2FsZW5kYXItZHVyYXRpb25zIGludGVycHJldGVkIGFzIGFuIEFnZSwgYW5kIHRoZSByZXN1bHQNCmlzIGEgRGF0ZVRpbWUgSW50ZXJ2YWwgYmVnaW5uaW5nIG9uIHRoZSBkYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGUgYWdlIGdpdmVuIGFzIHRoZSBzdGFydCBvZiB0aGUgcXVhbnRpdHkgaW50ZXJ2YWwsIGFuZCBlbmRpbmcNCmltbWVkaWF0ZWx5IGJlZm9yZSBvbmUgeWVhciBsYXRlciB0aGFuIHRoZSBkYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGUgYWdlIGdpdmVuIGFzIHRoZSBlbmQgb2YgdGhlIHF1YW50aXR5IGludGVydmFsLg0KQW55IG90aGVyIGlucHV0IHdpbGwgcmVzbHQgaW4gYSBudWxsIERhdGVUaW1lIEludGVydmFsDQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgdG9JbnRlcnZhbCgpYCBpbnN0ZWFkDQoqLw0KZGVmaW5lIGZ1bmN0aW9uIFRvSW50ZXJ2YWwoY2hvaWNlIENob2ljZTxEYXRlVGltZSwgUXVhbnRpdHksIEludGVydmFsPERhdGVUaW1lPiwgSW50ZXJ2YWw8UXVhbnRpdHk+Pik6DQogIGNhc2UNCgkgIHdoZW4gY2hvaWNlIGlzIERhdGVUaW1lIHRoZW4NCiAgICAJSW50ZXJ2YWxbY2hvaWNlIGFzIERhdGVUaW1lLCBjaG9pY2UgYXMgRGF0ZVRpbWVdDQoJCXdoZW4gY2hvaWNlIGlzIEludGVydmFsPERhdGVUaW1lPiB0aGVuDQogIAkJY2hvaWNlIGFzIEludGVydmFsPERhdGVUaW1lPg0KCQl3aGVuIGNob2ljZSBpcyBRdWFudGl0eSB0aGVuDQoJCSAgSW50ZXJ2YWxbUGF0aWVudC5iaXJ0aERhdGUgKyAoY2hvaWNlIGFzIFF1YW50aXR5KSwNCgkJCSAgUGF0aWVudC5iaXJ0aERhdGUgKyAoY2hvaWNlIGFzIFF1YW50aXR5KSArIDEgeWVhcikNCgkJd2hlbiBjaG9pY2UgaXMgSW50ZXJ2YWw8UXVhbnRpdHk+IHRoZW4NCgkJICBJbnRlcnZhbFtQYXRpZW50LmJpcnRoRGF0ZSArIChjaG9pY2UubG93IGFzIFF1YW50aXR5KSwNCgkJCSAgUGF0aWVudC5iaXJ0aERhdGUgKyAoY2hvaWNlLmhpZ2ggYXMgUXVhbnRpdHkpICsgMSB5ZWFyKQ0KCQl3aGVuIGNob2ljZSBpcyBRSUNvcmUuVGltaW5nIHRoZW4NCiAgICAgICAgICAgIG51bGwgYXMgSW50ZXJ2YWw8RGF0ZVRpbWU+DQoJCWVsc2UNCgkJCW51bGwgYXMgSW50ZXJ2YWw8RGF0ZVRpbWU+DQoJZW5kDQoNCi8qDQpAZGVzY3JpcHRpb246IE5vcm1hbGl6ZXMgYSB2YWx1ZSB0aGF0IGlzIGEgY2hvaWNlIG9mIHRpbWluZy12YWx1ZWQgdHlwZXMgdG8gYW4gZXF1aXZhbGVudCBpbnRlcnZhbA0KQGNvbW1lbnQ6IE5vcm1hbGl6ZXMgYSBjaG9pY2UgdHlwZSBvZiBEYXRlVGltZSwgUXVhbml0dHksIEludGVydmFsPERhdGVUaW1lPiwgb3IgSW50ZXJ2YWw8UXVhbnRpdHk+IHR5cGVzDQp0byBhbiBlcXVpdmFsZW50IGludGVydmFsLiBUaGlzIHNlbGVjdGlvbiBvZiBjaG9pY2UgdHlwZXMgaXMgYSBzdXBlcnNldCBvZiB0aGUgbWFqb3JpdHkgb2YgY2hvaWNlIHR5cGVzIHRoYXQgYXJlIHVzZWQgYXMgcG9zc2libGUNCnJlcHJlc2VudGF0aW9ucyBmb3IgdGltaW5nLXZhbHVlZCBlbGVtZW50cyBpbiBRSUNvcmUsIGFsbG93aW5nIHRoaXMgZnVuY3Rpb24gdG8gYmUgdXNlZCBhY3Jvc3MgYW55IHJlc291cmNlLg0KVGhlIGlucHV0IGNhbiBiZSBwcm92aWRlZCBhcyBhIERhdGVUaW1lLCBRdWFudGl0eSwgSW50ZXJ2YWw8RGF0ZVRpbWU+IG9yIEludGVydmFsPFF1YW50aXR5Pi4NClRoZSBpbnRlbnQgb2YgdGhpcyBmdW5jdGlvbiBpcyB0byBwcm92aWRlIGEgY2xlYXIgYW5kIGNvbmNpc2UgbWVjaGFuaXNtIHRvIHRyZWF0IHNpbmdsZQ0KZWxlbWVudHMgdGhhdCBoYXZlIG11bHRpcGxlIHBvc3NpYmxlIHJlcHJlc2VudGF0aW9ucyBhcyBpbnRlcnZhbHMgc28gdGhhdCBsb2dpYyBkb2Vzbid0IGhhdmUgdG8gYWNjb3VudA0KZm9yIHRoZSB2YXJpYWJpbGl0eS4gTW9yZSBjb21wbGV4IGNhbGN1bGF0aW9ucyAoc3VjaCBhcyBtZWRpY2F0aW9uIHJlcXVlc3QgcGVyaW9kIG9yIGRpc3BlbnNlIHBlcmlvZA0KY2FsY3VsYXRpb24pIG5lZWQgc3BlY2lmaWMgZ3VpZGFuY2UgYW5kIGNvbnNpZGVyYXRpb24uIFRoYXQgZ3VpZGFuY2UgbWF5IG1ha2UgdXNlIG9mIHRoaXMgZnVuY3Rpb24sIGJ1dA0KdGhlIGZvY3VzIG9mIHRoaXMgZnVuY3Rpb24gaXMgb24gc2luZ2xlIGVsZW1lbnQgY2FsY3VsYXRpb25zIHdoZXJlIHRoZSBzZW1hbnRpY3MgYXJlIHVuYW1iaWd1b3VzLg0KSWYgdGhlIGlucHV0IGlzIGEgRGF0ZVRpbWUsIHRoZSByZXN1bHQgYSBEYXRlVGltZSBJbnRlcnZhbCBiZWdpbm5pbmcgYW5kIGVuZGluZyBvbiB0aGF0IERhdGVUaW1lLg0KSWYgdGhlIGlucHV0IGlzIGEgUXVhbnRpdHksIHRoZSBxdWFudGl0eSBpcyBleHBlY3RlZCB0byBiZSBhIGNhbGVuZGFyLWR1cmF0aW9uIGludGVycHJldGVkIGFzIGFuIEFnZSwNCmFuZCB0aGUgcmVzdWx0IGlzIGEgRGF0ZVRpbWUgSW50ZXJ2YWwgYmVnaW5uaW5nIG9uIHRoZSBEYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGF0IGFnZSBhbmQgZW5kaW5nIGltbWVkaWF0ZWx5IGJlZm9yZSBvbmUgeWVhciBsYXRlci4NCklmIHRoZSBpbnB1dCBpcyBhIERhdGVUaW1lIEludGVydmFsLCB0aGUgcmVzdWx0IGlzIHRoZSBpbnB1dC4NCklmIHRoZSBpbnB1dCBpcyBhIFF1YW50aXR5IEludGVydmFsLCB0aGUgcXVhbnRpdGllcyBhcmUgZXhwZWN0ZWQgdG8gYmUgY2FsZW5kYXItZHVyYXRpb25zIGludGVycHJldGVkIGFzIGFuIEFnZSwgYW5kIHRoZSByZXN1bHQNCmlzIGEgRGF0ZVRpbWUgSW50ZXJ2YWwgYmVnaW5uaW5nIG9uIHRoZSBkYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGUgYWdlIGdpdmVuIGFzIHRoZSBzdGFydCBvZiB0aGUgcXVhbnRpdHkgaW50ZXJ2YWwsIGFuZCBlbmRpbmcNCmltbWVkaWF0ZWx5IGJlZm9yZSBvbmUgeWVhciBsYXRlciB0aGFuIHRoZSBkYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGUgYWdlIGdpdmVuIGFzIHRoZSBlbmQgb2YgdGhlIHF1YW50aXR5IGludGVydmFsLg0KQW55IG90aGVyIGlucHV0IHdpbGwgcmVzbHQgaW4gYSBudWxsIERhdGVUaW1lIEludGVydmFsDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiB0b0ludGVydmFsKGNob2ljZSBDaG9pY2U8RGF0ZVRpbWUsIFF1YW50aXR5LCBJbnRlcnZhbDxEYXRlVGltZT4sIEludGVydmFsPFF1YW50aXR5Pj4pOg0KICBjYXNlDQoJICB3aGVuIGNob2ljZSBpcyBEYXRlVGltZSB0aGVuDQogICAgCUludGVydmFsW2Nob2ljZSBhcyBEYXRlVGltZSwgY2hvaWNlIGFzIERhdGVUaW1lXQ0KCQl3aGVuIGNob2ljZSBpcyBJbnRlcnZhbDxEYXRlVGltZT4gdGhlbg0KICAJCWNob2ljZSBhcyBJbnRlcnZhbDxEYXRlVGltZT4NCgkJd2hlbiBjaG9pY2UgaXMgUXVhbnRpdHkgdGhlbg0KCQkgIEludGVydmFsW1BhdGllbnQuYmlydGhEYXRlICsgKGNob2ljZSBhcyBRdWFudGl0eSksDQoJCQkgIFBhdGllbnQuYmlydGhEYXRlICsgKGNob2ljZSBhcyBRdWFudGl0eSkgKyAxIHllYXIpDQoJCXdoZW4gY2hvaWNlIGlzIEludGVydmFsPFF1YW50aXR5PiB0aGVuDQoJCSAgSW50ZXJ2YWxbUGF0aWVudC5iaXJ0aERhdGUgKyAoY2hvaWNlLmxvdyBhcyBRdWFudGl0eSksDQoJCQkgIFBhdGllbnQuYmlydGhEYXRlICsgKGNob2ljZS5oaWdoIGFzIFF1YW50aXR5KSArIDEgeWVhcikNCgkJZWxzZQ0KCQkJbnVsbCBhcyBJbnRlcnZhbDxEYXRlVGltZT4NCgllbmQNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyBhbiBpbnRlcnZhbCByZXByZXNlbnRpbmcgdGhlIG5vcm1hbGl6ZWQgYWJhdGVtZW50IG9mIGEgZ2l2ZW4gQ29uZGl0aW9uLg0KQGNvbW1lbnQ6IElmIHRoZSBhYmF0ZW1lbnQgZWxlbWVudCBvZiB0aGUgQ29uZGl0aW9uIGlzIHJlcHJlc2VudGVkIGFzIGEgRGF0ZVRpbWUsIHRoZSByZXN1bHQNCmlzIGFuIGludGVydmFsIGJlZ2lubmluZyBhbmQgZW5kaW5nIG9uIHRoYXQgRGF0ZVRpbWUuDQpJZiB0aGUgYWJhdGVtZW50IGlzIHJlcHJlc2VudGVkIGFzIGEgUXVhbnRpdHksIHRoZSBxdWFudGl0eSBpcyBleHBlY3RlZCB0byBiZSBhIGNhbGVuZGFyLWR1cmF0aW9uIGFuZCBpcyBpbnRlcnByZXRlZCBhcyB0aGUgYWdlIG9mIHRoZSBwYXRpZW50LiBUaGUNCnJlc3VsdCBpcyBhbiBpbnRlcnZhbCBmcm9tIHRoZSBkYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGF0IGFnZSB0byBpbW1lZGlhdGVseSBiZWZvcmUgb25lIHllYXIgbGF0ZXIuDQpJZiB0aGUgYWJhdGVtZW50IGlzIHJlcHJlc2VudGVkIGFzIGEgUXVhbnRpdHkgSW50ZXJ2YWwsIHRoZSBxdWFudGl0aWVzIGFyZSBleHBlY3RlZCB0byBiZSBjYWxlbmRhci1kdXJhdGlvbnMgYW5kIGFyZSBpbnRlcnByZXRlZCBhcyBhbiBhZ2UgcmFuZ2UgZHVyaW5nDQp3aGljaCB0aGUgYWJhdGVtZW50IG9jY3VycmVkLiBUaGUgcmVzdWx0IGlzIGFuIGludGVydmFsIGZyb20gdGhlIGRhdGUgdGhlIHBhdGllbnQgdHVybmVkIHRoZSBzdGFydGluZyBhZ2Ugb2YgdGhlIHF1YW50aXR5IGludGVydmFsLCBhbmQgZW5kaW5nIGltbWVkaWF0ZWx5DQpiZWZvcmUgb25lIHllYXIgbGF0ZXIgdGhhbiB0aGUgZGF0ZSB0aGUgcGF0aWVudCB0dXJuZWQgdGhlIGVuZGluZyBhZ2Ugb2YgdGhlIHF1YW50aXR5IGludGVydmFsLg0KQGRlcHJlY2F0ZWQ6IFRoaXMgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZC4gVXNlIHRoZSBmbHVlbnQgZnVuY3Rpb24gYGFiYXRlbWVudEludGVydmFsKClgIGluc3RlYWQuDQoqLw0KZGVmaW5lIGZ1bmN0aW9uIFRvQWJhdGVtZW50SW50ZXJ2YWwoY29uZGl0aW9uIENvbmRpdGlvbik6DQoJaWYgY29uZGl0aW9uLmFiYXRlbWVudCBpcyBEYXRlVGltZSB0aGVuDQoJICBJbnRlcnZhbFtjb25kaXRpb24uYWJhdGVtZW50IGFzIERhdGVUaW1lLCBjb25kaXRpb24uYWJhdGVtZW50IGFzIERhdGVUaW1lXQ0KCWVsc2UgaWYgY29uZGl0aW9uLmFiYXRlbWVudCBpcyBRdWFudGl0eSB0aGVuDQoJCUludGVydmFsW1BhdGllbnQuYmlydGhEYXRlICsgKGNvbmRpdGlvbi5hYmF0ZW1lbnQgYXMgUXVhbnRpdHkpLA0KCQkJUGF0aWVudC5iaXJ0aERhdGUgKyAoY29uZGl0aW9uLmFiYXRlbWVudCBhcyBRdWFudGl0eSkgKyAxIHllYXIpDQoJZWxzZSBpZiBjb25kaXRpb24uYWJhdGVtZW50IGlzIEludGVydmFsPFF1YW50aXR5PiB0aGVuDQoJICBJbnRlcnZhbFtQYXRpZW50LmJpcnRoRGF0ZSArIChjb25kaXRpb24uYWJhdGVtZW50LmxvdyBhcyBRdWFudGl0eSksDQoJCSAgUGF0aWVudC5iaXJ0aERhdGUgKyAoY29uZGl0aW9uLmFiYXRlbWVudC5oaWdoIGFzIFF1YW50aXR5KSArIDEgeWVhcikNCgllbHNlIGlmIGNvbmRpdGlvbi5hYmF0ZW1lbnQgaXMgSW50ZXJ2YWw8RGF0ZVRpbWU+IHRoZW4NCgkgIEludGVydmFsW2NvbmRpdGlvbi5hYmF0ZW1lbnQubG93LCBjb25kaXRpb24uYWJhdGVtZW50LmhpZ2gpDQoJZWxzZSBudWxsIGFzIEludGVydmFsPERhdGVUaW1lPg0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIGFuIGludGVydmFsIHJlcHJlc2VudGluZyB0aGUgbm9ybWFsaXplZCBhYmF0ZW1lbnQgb2YgYSBnaXZlbiBDb25kaXRpb24uDQpAY29tbWVudDogSWYgdGhlIGFiYXRlbWVudCBlbGVtZW50IG9mIHRoZSBDb25kaXRpb24gaXMgcmVwcmVzZW50ZWQgYXMgYSBEYXRlVGltZSwgdGhlIHJlc3VsdA0KaXMgYW4gaW50ZXJ2YWwgYmVnaW5uaW5nIGFuZCBlbmRpbmcgb24gdGhhdCBEYXRlVGltZS4NCklmIHRoZSBhYmF0ZW1lbnQgaXMgcmVwcmVzZW50ZWQgYXMgYSBRdWFudGl0eSwgdGhlIHF1YW50aXR5IGlzIGV4cGVjdGVkIHRvIGJlIGEgY2FsZW5kYXItZHVyYXRpb24gYW5kIGlzIGludGVycHJldGVkIGFzIHRoZSBhZ2Ugb2YgdGhlIHBhdGllbnQuIFRoZQ0KcmVzdWx0IGlzIGFuIGludGVydmFsIGZyb20gdGhlIGRhdGUgdGhlIHBhdGllbnQgdHVybmVkIHRoYXQgYWdlIHRvIGltbWVkaWF0ZWx5IGJlZm9yZSBvbmUgeWVhciBsYXRlci4NCklmIHRoZSBhYmF0ZW1lbnQgaXMgcmVwcmVzZW50ZWQgYXMgYSBRdWFudGl0eSBJbnRlcnZhbCwgdGhlIHF1YW50aXRpZXMgYXJlIGV4cGVjdGVkIHRvIGJlIGNhbGVuZGFyLWR1cmF0aW9ucyBhbmQgYXJlIGludGVycHJldGVkIGFzIGFuIGFnZSByYW5nZSBkdXJpbmcNCndoaWNoIHRoZSBhYmF0ZW1lbnQgb2NjdXJyZWQuIFRoZSByZXN1bHQgaXMgYW4gaW50ZXJ2YWwgZnJvbSB0aGUgZGF0ZSB0aGUgcGF0aWVudCB0dXJuZWQgdGhlIHN0YXJ0aW5nIGFnZSBvZiB0aGUgcXVhbnRpdHkgaW50ZXJ2YWwsIGFuZCBlbmRpbmcgaW1tZWRpYXRlbHkNCmJlZm9yZSBvbmUgeWVhciBsYXRlciB0aGFuIHRoZSBkYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGUgZW5kaW5nIGFnZSBvZiB0aGUgcXVhbnRpdHkgaW50ZXJ2YWwuDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBhYmF0ZW1lbnRJbnRlcnZhbChjb25kaXRpb24gQ29uZGl0aW9uKToNCglpZiBjb25kaXRpb24uYWJhdGVtZW50IGlzIERhdGVUaW1lIHRoZW4NCgkgIEludGVydmFsW2NvbmRpdGlvbi5hYmF0ZW1lbnQgYXMgRGF0ZVRpbWUsIGNvbmRpdGlvbi5hYmF0ZW1lbnQgYXMgRGF0ZVRpbWVdDQoJZWxzZSBpZiBjb25kaXRpb24uYWJhdGVtZW50IGlzIFF1YW50aXR5IHRoZW4NCgkJSW50ZXJ2YWxbUGF0aWVudC5iaXJ0aERhdGUgKyAoY29uZGl0aW9uLmFiYXRlbWVudCBhcyBRdWFudGl0eSksDQoJCQlQYXRpZW50LmJpcnRoRGF0ZSArIChjb25kaXRpb24uYWJhdGVtZW50IGFzIFF1YW50aXR5KSArIDEgeWVhcikNCgllbHNlIGlmIGNvbmRpdGlvbi5hYmF0ZW1lbnQgaXMgSW50ZXJ2YWw8UXVhbnRpdHk+IHRoZW4NCgkgIEludGVydmFsW1BhdGllbnQuYmlydGhEYXRlICsgKGNvbmRpdGlvbi5hYmF0ZW1lbnQubG93IGFzIFF1YW50aXR5KSwNCgkJICBQYXRpZW50LmJpcnRoRGF0ZSArIChjb25kaXRpb24uYWJhdGVtZW50LmhpZ2ggYXMgUXVhbnRpdHkpICsgMSB5ZWFyKQ0KCWVsc2UgaWYgY29uZGl0aW9uLmFiYXRlbWVudCBpcyBJbnRlcnZhbDxEYXRlVGltZT4gdGhlbg0KCSAgSW50ZXJ2YWxbY29uZGl0aW9uLmFiYXRlbWVudC5sb3csIGNvbmRpdGlvbi5hYmF0ZW1lbnQuaGlnaCkNCgllbHNlIG51bGwgYXMgSW50ZXJ2YWw8RGF0ZVRpbWU+DQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgYW4gaW50ZXJ2YWwgcmVwcmVzZW50aW5nIHRoZSBub3JtYWxpemVkIHByZXZhbGVuY2UgcGVyaW9kIG9mIGEgZ2l2ZW4gQ29uZGl0aW9uLg0KQGNvbW1lbnQ6IFVzZXMgdGhlIFRvSW50ZXJ2YWwgYW5kIFRvQWJhdGVtZW50SW50ZXJ2YWwgZnVuY3Rpb25zIHRvIGRldGVybWluZSB0aGUgd2lkZXN0IHBvdGVudGlhbCBpbnRlcnZhbCBmcm9tDQpvbnNldCB0byBhYmF0ZW1lbnQgYXMgc3BlY2lmaWVkIGluIHRoZSBnaXZlbiBDb25kaXRpb24uIElmIHRoZSBjb25kaXRpb24gaXMgYWN0aXZlLCB0aGUgcmVzdWx0aW5nIGludGVydmFsIHdpbGwgaGF2ZQ0KYSBjbG9zZWQgZW5kaW5nIGJvdW5kYXJ5LiBJZiB0aGUgY29uZGl0aW9uIGlzIG5vdCBhY3RpdmUsIHRoZSByZXN1bHRpbmcgaW50ZXJ2YWwgd2lsbCBoYXZlIGFuIG9wZW4gZW5kaW5nIGJvdW5kYXJ5Lg0KQGRlcHJlY2F0ZWQ6IFRoaXMgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZC4gVXNlIHRoZSBgcHJldmFsZW5jZUludGVydmFsKClgIGZsdWVudCBmdW5jdGlvbiBpbnN0ZWFkDQoqLw0KZGVmaW5lIGZ1bmN0aW9uIFRvUHJldmFsZW5jZUludGVydmFsKGNvbmRpdGlvbiBDb25kaXRpb24pOg0KaWYgY29uZGl0aW9uLmNsaW5pY2FsU3RhdHVzIH4gImFjdGl2ZSINCiAgb3IgY29uZGl0aW9uLmNsaW5pY2FsU3RhdHVzIH4gInJlY3VycmVuY2UiDQogIG9yIGNvbmRpdGlvbi5jbGluaWNhbFN0YXR1cyB+ICJyZWxhcHNlIiB0aGVuDQogIEludGVydmFsW3N0YXJ0IG9mIFRvSW50ZXJ2YWwoY29uZGl0aW9uLm9uc2V0KSwgZW5kIG9mIFRvQWJhdGVtZW50SW50ZXJ2YWwoY29uZGl0aW9uKV0NCmVsc2UNCiAgSW50ZXJ2YWxbc3RhcnQgb2YgVG9JbnRlcnZhbChjb25kaXRpb24ub25zZXQpLCBlbmQgb2YgVG9BYmF0ZW1lbnRJbnRlcnZhbChjb25kaXRpb24pKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIGFuIGludGVydmFsIHJlcHJlc2VudGluZyB0aGUgbm9ybWFsaXplZCBwcmV2YWxlbmNlIHBlcmlvZCBvZiBhIGdpdmVuIENvbmRpdGlvbi4NCkBjb21tZW50OiBVc2VzIHRoZSBUb0ludGVydmFsIGFuZCBUb0FiYXRlbWVudEludGVydmFsIGZ1bmN0aW9ucyB0byBkZXRlcm1pbmUgdGhlIHdpZGVzdCBwb3RlbnRpYWwgaW50ZXJ2YWwgZnJvbQ0Kb25zZXQgdG8gYWJhdGVtZW50IGFzIHNwZWNpZmllZCBpbiB0aGUgZ2l2ZW4gQ29uZGl0aW9uLiBJZiB0aGUgY29uZGl0aW9uIGlzIGFjdGl2ZSwgdGhlIHJlc3VsdGluZyBpbnRlcnZhbCB3aWxsIGhhdmUNCmEgY2xvc2VkIGVuZGluZyBib3VuZGFyeS4gSWYgdGhlIGNvbmRpdGlvbiBpcyBub3QgYWN0aXZlLCB0aGUgcmVzdWx0aW5nIGludGVydmFsIHdpbGwgaGF2ZSBhbiBvcGVuIGVuZGluZyBib3VuZGFyeS4NCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIHByZXZhbGVuY2VJbnRlcnZhbChjb25kaXRpb24gQ29uZGl0aW9uKToNCmlmIGNvbmRpdGlvbi5jbGluaWNhbFN0YXR1cyB+ICJhY3RpdmUiDQogIG9yIGNvbmRpdGlvbi5jbGluaWNhbFN0YXR1cyB+ICJyZWN1cnJlbmNlIg0KICBvciBjb25kaXRpb24uY2xpbmljYWxTdGF0dXMgfiAicmVsYXBzZSIgdGhlbg0KICBJbnRlcnZhbFtzdGFydCBvZiBjb25kaXRpb24ub25zZXQudG9JbnRlcnZhbCgpLCBlbmQgb2YgY29uZGl0aW9uLmFiYXRlbWVudEludGVydmFsKCldDQplbHNlDQogIEludGVydmFsW3N0YXJ0IG9mIGNvbmRpdGlvbi5vbnNldC50b0ludGVydmFsKCksIGVuZCBvZiBjb25kaXRpb24uYWJhdGVtZW50SW50ZXJ2YWwoKSkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgdGFpbCBvZiB0aGUgZ2l2ZW4gdXJpIChpLmUuIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGxhc3Qgc2xhc2ggaW4gdGhlIFVSSSkuDQpAY29tbWVudDogVGhpcyBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBkZXRlcm1pbmUgdGhlIGxvZ2ljYWwgaWQgb2YgYSBnaXZlbiByZXNvdXJjZS4gSXQgY2FuIGJlIHVzZWQgaW4NCmEgc2luZ2xlLXNlcnZlciBlbnZpcm9ubWVudCB0byB0cmFjZSByZWZlcmVuY2VzLiBIb3dldmVyLCB0aGlzIGZ1bmN0aW9uIGRvZXMgbm90IGF0dGVtcHQgdG8gcmVzb2x2ZQ0Kb3IgZGlzdGluZ3Vpc2ggdGhlIGJhc2Ugb2YgdGhlIGdpdmVuIHVybCwgYW5kIHNvIGNhbm5vdCBiZSB1c2VkIHNhZmVseSBpbiBtdWx0aS1zZXJ2ZXIgZW52aXJvbm1lbnRzLg0KQGRlcHJlY2F0ZWQ6IFRoaXMgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZC4gVXNlIHRoZSBmbHVlbnQgZnVuY3Rpb24gYGdldElkKClgIGluc3RlYWQNCiovDQpkZWZpbmUgZnVuY3Rpb24gR2V0SWQodXJpIFN0cmluZyApOg0KICBMYXN0KFNwbGl0KHVyaSwgJy8nKSkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgdGFpbCBvZiB0aGUgZ2l2ZW4gdXJpIChpLmUuIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGxhc3Qgc2xhc2ggaW4gdGhlIFVSSSkuDQpAY29tbWVudDogVGhpcyBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBkZXRlcm1pbmUgdGhlIGxvZ2ljYWwgaWQgb2YgYSBnaXZlbiByZXNvdXJjZS4gSXQgY2FuIGJlIHVzZWQgaW4NCmEgc2luZ2xlLXNlcnZlciBlbnZpcm9ubWVudCB0byB0cmFjZSByZWZlcmVuY2VzLiBIb3dldmVyLCB0aGlzIGZ1bmN0aW9uIGRvZXMgbm90IGF0dGVtcHQgdG8gcmVzb2x2ZQ0Kb3IgZGlzdGluZ3Vpc2ggdGhlIGJhc2Ugb2YgdGhlIGdpdmVuIHVybCwgYW5kIHNvIGNhbm5vdCBiZSB1c2VkIHNhZmVseSBpbiBtdWx0aS1zZXJ2ZXIgZW52aXJvbm1lbnRzLg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gZ2V0SWQodXJpIFN0cmluZyk6DQogIExhc3QoU3BsaXQodXJpLCAnLycpKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBHaXZlbiBhbiBpbnRlcnZhbCwgcmV0dXJuIHRydWUgaWYgdGhlIGludGVydmFsIGhhcyBhIHN0YXJ0aW5nIGJvdW5kYXJ5IHNwZWNpZmllZA0KKGkuZS4gdGhlIHN0YXJ0IG9mIHRoZSBpbnRlcnZhbCBpcyBub3QgbnVsbCBhbmQgbm90IHRoZSBtaW5pbXVtIERhdGVUaW1lIHZhbHVlKQ0KQGRlcHJlY2F0ZWQ6IFRoaXMgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZC4gVWVlIHRoZSBmbHVlbnQgZnVuY3Rpb24gYGhhc1N0YXJ0KClgIGluc3RlYWQNCiovDQpkZWZpbmUgZnVuY3Rpb24gIkhhc1N0YXJ0IihwZXJpb2QgSW50ZXJ2YWw8RGF0ZVRpbWU+ICk6DQogIG5vdCAoIHN0YXJ0IG9mIHBlcmlvZCBpcyBudWxsDQogICAgICBvciBzdGFydCBvZiBwZXJpb2QgPSBtaW5pbXVtIERhdGVUaW1lDQogICkNCg0KLyoNCkBkZXNjcmlwdGlvbjogR2l2ZW4gYW4gaW50ZXJ2YWwsIHJldHVybiB0cnVlIGlmIHRoZSBpbnRlcnZhbCBoYXMgYSBzdGFydGluZyBib3VuZGFyeSBzcGVjaWZpZWQNCihpLmUuIHRoZSBzdGFydCBvZiB0aGUgaW50ZXJ2YWwgaXMgbm90IG51bGwgYW5kIG5vdCB0aGUgbWluaW11bSBEYXRlVGltZSB2YWx1ZSkNCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGhhc1N0YXJ0KHBlcmlvZCBJbnRlcnZhbDxEYXRlVGltZT4gKToNCiAgbm90ICggc3RhcnQgb2YgcGVyaW9kIGlzIG51bGwNCiAgICAgIG9yIHN0YXJ0IG9mIHBlcmlvZCA9IG1pbmltdW0gRGF0ZVRpbWUNCiAgKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBHaXZlbiBhbiBpbnRlcnZhbCwgcmV0dXJucyB0cnVlIGlmIHRoZSBpbnRlcnZhbCBoYXMgYW4gZW5kaW5nIGJvdW5kYXJ5IHNwZWNpZmllZA0KKGkuZS4gdGhlIGVuZCBvZiB0aGUgaW50ZXJ2YWwgaXMgbm90IG51bGwgYW5kIG5vdCB0aGUgbWF4aW11bSBEYXRlVGltZSB2YWx1ZSkNCkBkZXByZWNhdGVkOiBUaGlzIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQuIFVzZSB0aGUgZmx1ZW50IGZ1bmN0aW9uIGBoYXNFbmQoKWAgaW5zdGVhZA0KKi8NCmRlZmluZSBmdW5jdGlvbiAiSGFzRW5kIihwZXJpb2QgSW50ZXJ2YWw8RGF0ZVRpbWU+ICk6DQogIG5vdCAoDQogICAgZW5kIG9mIHBlcmlvZCBpcyBudWxsDQogICAgICBvciBlbmQgb2YgcGVyaW9kID0gbWF4aW11bSBEYXRlVGltZQ0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IEdpdmVuIGFuIGludGVydmFsLCByZXR1cm5zIHRydWUgaWYgdGhlIGludGVydmFsIGhhcyBhbiBlbmRpbmcgYm91bmRhcnkgc3BlY2lmaWVkDQooaS5lLiB0aGUgZW5kIG9mIHRoZSBpbnRlcnZhbCBpcyBub3QgbnVsbCBhbmQgbm90IHRoZSBtYXhpbXVtIERhdGVUaW1lIHZhbHVlKQ0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaGFzRW5kKHBlcmlvZCBJbnRlcnZhbDxEYXRlVGltZT4gKToNCiAgbm90ICgNCiAgICBlbmQgb2YgcGVyaW9kIGlzIG51bGwNCiAgICAgIG9yIGVuZCBvZiBwZXJpb2QgPSBtYXhpbXVtIERhdGVUaW1lDQogICkNCg0KLyoNCkBkZXNjcmlwdGlvbjogR2l2ZW4gYW4gaW50ZXJ2YWwsIHJldHVybnMgdGhlIGVuZGluZyBwb2ludCBpZiB0aGUgaW50ZXJ2YWwgaGFzIGFuIGVuZGluZyBib3VuZGFyeSBzcGVjaWZpZWQsDQpvdGhlcndpc2UsIHJldHVybnMgdGhlIHN0YXJ0aW5nIHBvaW50DQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgbGF0ZXN0KClgIGluc3RlYWQNCiovDQpkZWZpbmUgZnVuY3Rpb24gIkxhdGVzdCIoY2hvaWNlIENob2ljZTxEYXRlVGltZSwgUXVhbnRpdHksIEludGVydmFsPERhdGVUaW1lPiwgSW50ZXJ2YWw8UXVhbnRpdHk+PiApOg0KICAoY2hvaWNlLnRvSW50ZXJ2YWwoKSkgcGVyaW9kDQogICAgcmV0dXJuDQogICAgICBpZiAoSGFzRW5kKHBlcmlvZCkpIHRoZW4gZW5kIG9mIHBlcmlvZA0KICAgICAgZWxzZSBzdGFydCBvZiBwZXJpb2QNCg0KLyoNCkBkZXNjcmlwdGlvbjogR2l2ZW4gYW4gaW50ZXJ2YWwsIHJldHVybnMgdGhlIGVuZGluZyBwb2ludCBpZiB0aGUgaW50ZXJ2YWwgaGFzIGFuIGVuZGluZyBib3VuZGFyeSBzcGVjaWZpZWQsDQpvdGhlcndpc2UsIHJldHVybnMgdGhlIHN0YXJ0aW5nIHBvaW50DQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBsYXRlc3QoY2hvaWNlIENob2ljZTxEYXRlVGltZSwgUXVhbnRpdHksIEludGVydmFsPERhdGVUaW1lPiwgSW50ZXJ2YWw8UXVhbnRpdHk+PiApOg0KICAoY2hvaWNlLnRvSW50ZXJ2YWwoKSkgcGVyaW9kDQogICAgcmV0dXJuDQogICAgICBpZiAocGVyaW9kLiJoYXNFbmQiKCkpIHRoZW4gZW5kIG9mIHBlcmlvZA0KICAgICAgZWxzZSBzdGFydCBvZiBwZXJpb2QNCg0KLyoNCkBkZXNjcmlwdGlvbjogR2l2ZW4gYW4gaW50ZXJ2YWwsIHJldHVybiB0aGUgc3RhcnRpbmcgcG9pbnQgaWYgdGhlIGludGVydmFsIGhhcyBhIHN0YXJ0aW5nIGJvdW5kYXJ5IHNwZWNpZmllZCwNCm90aGVyd2lzZSwgcmV0dXJuIHRoZSBlbmRpbmcgcG9pbnQNCkBkZXByZWNhdGVkOiBUaGlzIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQuIFVzZSB0aGUgZmx1ZW50IGZ1bmN0aW9uIGBlYXJsaWVzdCgpYCBpbnN0ZWFkDQoqLw0KZGVmaW5lIGZ1bmN0aW9uICJFYXJsaWVzdCIoY2hvaWNlIENob2ljZTxEYXRlVGltZSwgUXVhbnRpdHksIEludGVydmFsPERhdGVUaW1lPiwgSW50ZXJ2YWw8UXVhbnRpdHk+PiApOg0KICAoY2hvaWNlLnRvSW50ZXJ2YWwoKSkgcGVyaW9kDQogICAgcmV0dXJuDQogICAgICBpZiAoSGFzU3RhcnQocGVyaW9kKSkgdGhlbiBzdGFydCBvZiBwZXJpb2QNCiAgICAgIGVsc2UgZW5kIG9mIHBlcmlvZA0KDQovKg0KQGRlc2NyaXB0aW9uOiBHaXZlbiBhbiBpbnRlcnZhbCwgcmV0dXJuIHRoZSBzdGFydGluZyBwb2ludCBpZiB0aGUgaW50ZXJ2YWwgaGFzIGEgc3RhcnRpbmcgYm91bmRhcnkgc3BlY2lmaWVkLA0Kb3RoZXJ3aXNlLCByZXR1cm4gdGhlIGVuZGluZyBwb2ludA0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gZWFybGllc3QoY2hvaWNlIENob2ljZTxEYXRlVGltZSwgUXVhbnRpdHksIEludGVydmFsPERhdGVUaW1lPiwgSW50ZXJ2YWw8UXVhbnRpdHk+PiApOg0KICAoY2hvaWNlLnRvSW50ZXJ2YWwoKSkgcGVyaW9kDQogICAgcmV0dXJuDQogICAgICBpZiAocGVyaW9kLiJoYXNTdGFydCIoKSkgdGhlbiBzdGFydCBvZiBwZXJpb2QNCiAgICAgIGVsc2UgZW5kIG9mIHBlcmlvZA0KDQovKg0KQGRlc2NyaXB0aW9uOiBDcmVhdGVzIGEgbGlzdCBvZiBpbnRlZ2VycyBmcm9tIDEgdG8gaG93IG1hbnkgZGF5cyBhcmUgaW4gdGhlIGludGVydmFsLiBOb3RlLCB0aGlzIHdvbnQgY3JlYXRlIGFuIGluZGV4IGZvcg0KdGhlIGZpbmFsIGRheSBpZiBpdCBpcyBsZXNzIHRoYW4gMjQgaG91cnMuIFRoaXMgYWxzbyBpbmNsdWRlcyB0aGUgZmlyc3QgMjQgaG91ciBwZXJpb2QuDQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgdG9EYXlOdW1iZXJzKClgIGluc3RlYWQNCiovDQpkZWZpbmUgZnVuY3Rpb24gIkludGVydmFsIFRvIERheSBOdW1iZXJzIihQZXJpb2QgSW50ZXJ2YWw8RGF0ZVRpbWU+KToNCiAgKCBleHBhbmQgeyBJbnRlcnZhbFsxLCBkdXJhdGlvbiBpbiBkYXlzIGJldHdlZW4gc3RhcnQgb2YgUGVyaW9kIGFuZCBlbmQgb2YgUGVyaW9kXX0gKSBEYXlOdW1iZXINCiAgICByZXR1cm4gZW5kIG9mIERheU51bWJlcg0KDQovKg0KQGRlc2NyaXB0aW9uOiBDcmVhdGVzIGEgbGlzdCBvZiBpbnRlZ2VycyBmcm9tIDEgdG8gaG93IG1hbnkgZGF5cyBhcmUgaW4gdGhlIGludGVydmFsLiBOb3RlLCB0aGlzIHdvbnQgY3JlYXRlIGFuIGluZGV4IGZvcg0KdGhlIGZpbmFsIGRheSBpZiBpdCBpcyBsZXNzIHRoYW4gMjQgaG91cnMuIFRoaXMgYWxzbyBpbmNsdWRlcyB0aGUgZmlyc3QgMjQgaG91ciBwZXJpb2QuDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiB0b0RheU51bWJlcnMoUGVyaW9kIEludGVydmFsPERhdGVUaW1lPik6DQogICggZXhwYW5kIHsgSW50ZXJ2YWxbMSwgZHVyYXRpb24gaW4gZGF5cyBiZXR3ZWVuIHN0YXJ0IG9mIFBlcmlvZCBhbmQgZW5kIG9mIFBlcmlvZF19ICkgRGF5TnVtYmVyDQogICAgcmV0dXJuIGVuZCBvZiBEYXlOdW1iZXINCg0KLyoNCkBkZXNjcmlwdGlvbjogQ3JlYXRlcyBhIGxpc3Qgb2YgMjQgaG91ciBsb25nIGludGVydmFscyBpbiBhbiBpbnRlcnZhbCBwYWlyZWQgd2l0aCB0aGUgaW5kZXggKDEgaW5kZXhlZCkgdG8gd2hpY2ggMjQgaG91ciBpbnRlcnZhbCBpdCBpcy4NCk5vdGUgdGhhdCB0aGUgcmVzdWx0IHdpbGwgaW5jbHVkZSBpbnRlcnZhbHMgdGhhdCBhcmUgY2xvc2VkIGF0IHRoZSBiZWdpbm5pbmcgYW5kIG9wZW4gYXQgdGhlIGVuZA0KQGRlcHJlY2F0ZWQ6IFRoaXMgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZC4gVXNlIHRoZSBmbHVlbnQgZnVuY3Rpb24gYGRheXNJblBlcmlvZCgpYCBpbnN0ZWFkDQoqLw0KZGVmaW5lIGZ1bmN0aW9uICJEYXlzIEluIFBlcmlvZCIoUGVyaW9kIEludGVydmFsPERhdGVUaW1lPik6DQogICggIkludGVydmFsIFRvIERheSBOdW1iZXJzIihQZXJpb2QpKSBEYXlJbmRleA0KICAgIGxldCBzdGFydFBlcmlvZDogc3RhcnQgb2YgUGVyaW9kICsgKDI0IGhvdXJzICogKERheUluZGV4IC0gMSkpLA0KICAgIGVuZFBlcmlvZDogaWYgKGhvdXJzIGJldHdlZW4gc3RhcnRQZXJpb2QgYW5kIGVuZCBvZiBQZXJpb2QgPCAyNCkgdGhlbiBzdGFydFBlcmlvZA0KICAgICAgZWxzZSBzdGFydCBvZiBQZXJpb2QgKyAoMjQgaG91cnMgKiBEYXlJbmRleCkNCiAgICByZXR1cm4gVHVwbGUgew0KICAgICAgZGF5SW5kZXg6IERheUluZGV4LA0KICAgICAgZGF5UGVyaW9kOiBJbnRlcnZhbFtzdGFydFBlcmlvZCwgZW5kUGVyaW9kKQ0KICAgIH0NCg0KLyoNCkBkZXNjcmlwdGlvbjogQ3JlYXRlcyBhIGxpc3Qgb2YgMjQgaG91ciBsb25nIGludGVydmFscyBpbiBhbiBpbnRlcnZhbCBwYWlyZWQgd2l0aCB0aGUgaW5kZXggKDEgaW5kZXhlZCkgdG8gd2hpY2ggMjQgaG91ciBpbnRlcnZhbCBpdCBpcy4NCk5vdGUgdGhhdCB0aGUgcmVzdWx0IHdpbGwgaW5jbHVkZSBpbnRlcnZhbHMgdGhhdCBhcmUgY2xvc2VkIGF0IHRoZSBiZWdpbm5pbmcgYW5kIG9wZW4gYXQgdGhlIGVuZA0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gZGF5c0luUGVyaW9kKFBlcmlvZCBJbnRlcnZhbDxEYXRlVGltZT4pOg0KICAoICJJbnRlcnZhbCBUbyBEYXkgTnVtYmVycyIoUGVyaW9kKSkgRGF5SW5kZXgNCiAgICBsZXQgc3RhcnRQZXJpb2Q6IHN0YXJ0IG9mIFBlcmlvZCArICgyNCBob3VycyAqIChEYXlJbmRleCAtIDEpKSwNCiAgICBlbmRQZXJpb2Q6IGlmIChob3VycyBiZXR3ZWVuIHN0YXJ0UGVyaW9kIGFuZCBlbmQgb2YgUGVyaW9kIDwgMjQpIHRoZW4gc3RhcnRQZXJpb2QNCiAgICAgIGVsc2Ugc3RhcnQgb2YgUGVyaW9kICsgKDI0IGhvdXJzICogRGF5SW5kZXgpDQogICAgcmV0dXJuIFR1cGxlIHsNCiAgICAgIGRheUluZGV4OiBEYXlJbmRleCwNCiAgICAgIGRheVBlcmlvZDogSW50ZXJ2YWxbc3RhcnRQZXJpb2QsIGVuZFBlcmlvZCkNCiAgICB9"
  } ]
}